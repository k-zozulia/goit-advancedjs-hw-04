{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\nconst API_KEY = '49492514-812d245cc52e4f29e485c4df0';\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\n\r\nconst REQUEST_PARAMS = {\r\n  key: API_KEY,\r\n  image_type: 'photo',\r\n  orientation: 'horizontal',\r\n  safesearch: 'true',\r\n  per_page: 15,\r\n};\r\n\r\nfunction handleError(message) {\r\n  iziToast.show({\r\n    message,\r\n    position: 'topRight',\r\n    timeout: 7000,\r\n    backgroundColor: '#EF4040',\r\n    messageColor: '#FAFAFB',\r\n    iconUrl: './img/icons/close.svg',\r\n    closeOnEscape: true,\r\n    closeOnClick: true,\r\n    maxWidth: '432px',\r\n  });\r\n}\r\n\r\nfunction handleInfo(message) {\r\n  iziToast.show({\r\n    message,\r\n    position: 'topRight',\r\n    timeout: 5000,\r\n    backgroundColor: '#59A10D',\r\n    messageColor: '#FAFAFB',\r\n    closeOnEscape: true,\r\n    closeOnClick: true,\r\n    maxWidth: '432px',\r\n  });\r\n}\r\n\r\nasync function fetchImagesFromAPI(searchQuery, page = 1) {\r\n  const loadingIndicator = document.getElementById('loader');\r\n  loadingIndicator.style.display = 'flex';\r\n\r\n  try {\r\n    const response = await axios.get(BASE_URL, {\r\n      params: { ...REQUEST_PARAMS, q: searchQuery, page },\r\n    });\r\n    return response.data;\r\n  } catch (error) {\r\n    handleError('Failed to fetch images');\r\n    throw error;\r\n  } finally {\r\n    loadingIndicator.style.display = 'none';\r\n  }\r\n}\r\n\r\nexport { fetchImagesFromAPI, handleError, handleInfo };","import { handleError } from './pixabay-api.js';\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nlet lightboxInstance = null;\r\n\r\nfunction renderImages({ totalHits, hits }, append = false) {\r\n  const galleryContainer = document.getElementById('gallery');\r\n  \r\n  if (!append) {\r\n    galleryContainer.innerHTML = '';\r\n  }\r\n\r\n  if (hits.length === 0) {\r\n    handleError('Sorry, there are no images matching your search query. Please try again!');\r\n    return null;\r\n  }\r\n\r\n  hits.forEach(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }, index) => {\r\n    const imageStats = [\r\n      { title: 'Likes', value: likes },\r\n      { title: 'Views', value: views },\r\n      { title: 'Comments', value: comments },\r\n      { title: 'Downloads', value: downloads },\r\n    ];\r\n\r\n    const imageInfoHTML = imageStats\r\n      .map(({ title, value }) => `\r\n        <div class=\"info-block\">\r\n          <span class=\"info-title\">${title}</span>\r\n          <span class=\"info-value\">${value}</span>\r\n        </div>\r\n      `)\r\n      .join('');\r\n\r\n    const imageItem = document.createElement('li');\r\n    imageItem.classList.add('gallery-item');\r\n\r\n    imageItem.innerHTML = `\r\n      <a href=\"${largeImageURL}\" class=\"gallery-link\">\r\n        <div class=\"image-wrapper\">\r\n          <img\r\n            src=\"${webformatURL}\"\r\n            alt=\"${tags}\"\r\n            class=\"gallery-image hidden\"\r\n          />\r\n        </div>\r\n      </a>\r\n      <div class=\"gallery-info\">\r\n        ${imageInfoHTML}\r\n      </div>\r\n    `;\r\n\r\n    const imgElement = imageItem.querySelector('.gallery-image');\r\n\r\n    imgElement.onload = () => {\r\n      imgElement.classList.remove('hidden');\r\n    };\r\n\r\n    galleryContainer.appendChild(imageItem);\r\n\r\n    setTimeout(() => {\r\n      imageItem.classList.add('fade-in');\r\n    }, index * 100);\r\n  });\r\n\r\n  if (!lightboxInstance) {\r\n    lightboxInstance = new SimpleLightbox('.gallery a', {\r\n      captionsData: 'alt',\r\n      captionDelay: 250,\r\n      overlayOpacity: 0.8,\r\n    });\r\n  } else {\r\n    lightboxInstance.refresh();\r\n  }\r\n\r\n  if (galleryContainer.children.length > 0) {\r\n    const firstCard = galleryContainer.children[0];\r\n    const cardRect = firstCard.getBoundingClientRect();\r\n    const galleryStyle = window.getComputedStyle(galleryContainer);\r\n    const gap = parseInt(galleryStyle.gap) || 24;\r\n    return cardRect.height + gap;\r\n  }\r\n  return 0;\r\n}\r\n\r\nexport { renderImages };","import { fetchImagesFromAPI, handleError, handleInfo } from './js/pixabay-api.js';\r\nimport { renderImages } from './js/render-functions.js';\r\n\r\nconst elements = {\r\n  form: document.getElementById('searchForm'),\r\n  inputField: document.getElementById('searchInput'),\r\n  gallery: document.getElementById('gallery'),\r\n  loadMoreBtn: document.getElementById('loadMoreBtn'),\r\n  loader: document.getElementById('loader'),\r\n};\r\n\r\nlet currentPage = 1;\r\nlet currentQuery = '';\r\nlet totalHits = 0;\r\n\r\nelements.form.addEventListener('submit', async (event) => {\r\n  event.preventDefault();\r\n  \r\n  currentQuery = elements.inputField.value.trim();\r\n  if (!currentQuery) return;\r\n\r\n  currentPage = 1;\r\n  elements.gallery.innerHTML = '';\r\n  elements.loadMoreBtn.style.display = 'none';\r\n  elements.loader.style.display = 'flex';\r\n  \r\n  try {\r\n    const imagesData = await fetchImagesFromAPI(currentQuery, currentPage);\r\n    totalHits = imagesData.totalHits;\r\n    renderImages(imagesData);\r\n    \r\n    if (elements.gallery.children.length > 0) {\r\n      const header = document.querySelector('header');\r\n      const headerHeight = header ? header.offsetHeight : 0;\r\n      const galleryPosition = elements.gallery.getBoundingClientRect().top + window.scrollY;\r\n      \r\n      window.scrollTo({\r\n        top: galleryPosition - headerHeight - 20,\r\n        behavior: 'smooth'\r\n      });\r\n    }\r\n    \r\n    if (totalHits > 15) {\r\n      elements.loadMoreBtn.style.display = 'block';\r\n    } else if (imagesData.hits.length > 0 && imagesData.hits.length === totalHits) {\r\n      handleInfo(\"We're sorry, but you've reached the end of search results.\");\r\n    }\r\n  } catch (error) {\r\n    console.error('Error:', error);\r\n  } finally {\r\n    elements.loader.style.display = 'none';\r\n    elements.inputField.blur();\r\n  }\r\n});\r\n\r\nelements.loadMoreBtn.addEventListener('click', async () => {\r\n  currentPage += 1;\r\n  elements.loadMoreBtn.style.display = 'none';\r\n  elements.loader.style.display = 'flex';\r\n  \r\n  try {\r\n    const imagesData = await fetchImagesFromAPI(currentQuery, currentPage);\r\n    const scrollHeight = renderImages(imagesData, true);\r\n    \r\n    if (scrollHeight) {\r\n      const galleryWidth = elements.gallery.clientWidth;\r\n      const cardWidth = 358;\r\n      const gap = 24;\r\n      const cardsPerRow = Math.floor((galleryWidth + gap) / (cardWidth + gap));\r\n      const newRows = Math.ceil(imagesData.hits.length / cardsPerRow);\r\n      \r\n      window.scrollBy({\r\n        top: scrollHeight * newRows,\r\n        behavior: 'smooth'\r\n      });\r\n    }\r\n    \r\n    const loadedItems = currentPage * 15;\r\n    if (loadedItems >= totalHits) {\r\n      elements.loadMoreBtn.style.display = 'none';\r\n      handleInfo(\"We're sorry, but you've reached the end of search results.\");\r\n    } else {\r\n      elements.loadMoreBtn.style.display = 'block';\r\n    }\r\n  } catch (error) {\r\n    console.error('Error:', error);\r\n  } finally {\r\n    elements.loader.style.display = 'none';\r\n  }\r\n});"],"names":["API_KEY","BASE_URL","REQUEST_PARAMS","handleError","message","iziToast","handleInfo","fetchImagesFromAPI","searchQuery","page","loadingIndicator","axios","error","lightboxInstance","renderImages","totalHits","hits","append","galleryContainer","webformatURL","largeImageURL","tags","likes","views","comments","downloads","index","imageInfoHTML","title","value","imageItem","imgElement","SimpleLightbox","cardRect","galleryStyle","gap","elements","currentPage","currentQuery","event","imagesData","header","headerHeight","galleryPosition","scrollHeight","galleryWidth","cardWidth","cardsPerRow","newRows"],"mappings":"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"}